<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>3D Store Tour</title>
<style>
  body { margin:0; overflow:hidden; }
  #tip {
    position: fixed; bottom: 15px; left: 15px;
    background: rgba(0,0,0,.6); color:#fff;
    padding: 8px 10px; border-radius:10px;
    font-family: sans-serif; font-size: 12px;
  }
</style>
</head>
<body>

<div id="tip">
  Click scene → WASD to move | Mouse to look | Scroll to zoom | Click objects for info
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.164/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.164/examples/js/controls/OrbitControls.js"></script>

<script>
/* ---- BASIC SETUP ---- */
const scene = new THREE.Scene();
scene.background = new THREE.Color("#f2f3f5");   // IKEA clean theme

const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 1000);
camera.position.set(0, 2, 8);

const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enablePan = false;

/* ---- LIGHTS ---- */
scene.add(new THREE.AmbientLight(0xffffff, .6));
const d = new THREE.DirectionalLight(0xffffff, 1);
d.position.set(4, 10, 6);
scene.add(d);

/* ---- FLOOR (light grey IKEA) ---- */
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(40, 40),
  new THREE.MeshStandardMaterial({ color: "#e6e6e6" })
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

/* ---- ROOM BOX ---- */
const room = new THREE.Mesh(
  new THREE.BoxGeometry(40, 10, 40),
  new THREE.MeshStandardMaterial({ color:"#ffffff", side:THREE.BackSide })
);
room.position.y = 5;
scene.add(room);

/* ---- IKEA COLOR STRIP WALL ---- */
const strip = new THREE.Mesh(
  new THREE.PlaneGeometry(40, 1.6),
  new THREE.MeshStandardMaterial({ color:"#0058a3" })   // IKEA Blue
);
strip.position.set(0, 4.2, -19.9);
scene.add(strip);

const strip2 = new THREE.Mesh(
  new THREE.PlaneGeometry(40, .5),
  new THREE.MeshStandardMaterial({ color:"#ffcc00" })   // IKEA Yellow
);
strip2.position.set(0, 3.2, -19.9);
scene.add(strip2);

/* ---- SIMPLE FURNITURE (shelves + tables) ---- */
const clickable = [];

function shelf(x,z){
  const s = new THREE.Mesh(
    new THREE.BoxGeometry(3,2,1),
    new THREE.MeshStandardMaterial({ color:"#f4f4f4" })
  );
  s.position.set(x,1,z);
  s.userData = { label:"Shelf — Storage & Organization" };
  scene.add(s);
  clickable.push(s);
}
shelf(-6, -5);
shelf(0, -8);
shelf(6, -5);

function table(x,z){
  const t = new THREE.Mesh(
    new THREE.BoxGeometry(2,1,2),
    new THREE.MeshStandardMaterial({ color:"#dcdcdc" })
  );
  t.position.set(x,.5,z);
  t.userData = { label:"Table — Living Room Display" };
  scene.add(t);
  clickable.push(t);
}
table(-4, 3);
table(4, 4);

/* ---- HOTSPOT BALL ---- */
function hotspot(x,y,z,text){
  const h = new THREE.Mesh(
    new THREE.SphereGeometry(.18,16,16),
    new THREE.MeshStandardMaterial({ color:"#ffcc00", emissive:"#ffcc00" })
  );
  h.position.set(x,y,z);
  h.userData = { label:text };
  scene.add(h);
  clickable.push(h);
}
hotspot(0,1.2,-10, "Entrance → Customer Flow Starts Here");
hotspot(6,1.2,-5, "Racks with popular products");

/* ---- WALK MOVEMENT (WASD) ---- */
const keys = {};
addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
addEventListener("keyup",   e => keys[e.key.toLowerCase()] = false);

function move(){
  const speed = 0.08;
  const forward = new THREE.Vector3();
  camera.getWorldDirection(forward);

  if(keys["w"]) camera.position.addScaledVector(forward, speed);
  if(keys["s"]) camera.position.addScaledVector(forward, -speed);

  const right = new THREE.Vector3().crossVectors(camera.up, forward).normalize();
  if(keys["a"]) camera.position.addScaledVector(right, speed);
  if(keys["d"]) camera.position.addScaledVector(right, -speed);
}

/* ---- CLICKABLE RAYCAST ---- */
const ray = new THREE.Raycaster();
const mouse = new THREE.Vector2();

addEventListener("click", (e)=>{
  mouse.x = (e.clientX / innerWidth) * 2 - 1;
  mouse.y = -(e.clientY / innerHeight) * 2 + 1;
  ray.setFromCamera(mouse, camera);

  const hit = ray.intersectObjects(clickable);
  if(hit.length){
    alert(hit[0].object.userData.label);
  }
});

/* ---- LOOP ---- */
function animate(){
  requestAnimationFrame(animate);
  move();
  controls.update();
  renderer.render(scene, camera);
}
animate();

/* ---- RESIZE ---- */
addEventListener("resize", ()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});
</script>
</body>
</html>

